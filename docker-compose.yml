#This specifies the version of the docker compose file
version: "3.9"
services:
  #This corresponds to a list of services we want to launch/
  #We're using the postgres database
  postgres:
    #Built-in image for postgres database
    image: postgres:12-alpine

    #Environment variables we want to use
    environment:
      - POSTGRES_USER=root
      - POSTGRES_PASSWORD=secret
      - POSTGRES_DB=simple_bank
  #The API service
  api: 
    #For this service we should build the image in our Dockerfile for the golang source
    build: 
      #This means build the image in the context of the current root folder
      context: .
      #This tells docker compose where to build the image. Here, it's just the docker file at the root of the project
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - DB_SOURCE=postgresql://root:secret@postgres:5432/simple_bank?sslmode=disable